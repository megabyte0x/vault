---
description: Documentation standards using NatSpec comments for autogenerated docs and improved code readability.
---

## Commenting

1. For public or external methods and variables, use [NatSpec](https://docs.soliditylang.org/en/latest/natspec-format.html) comments.

| Tag           | Description                                                               | Contenxt                                                                                               |
| ------------- | ------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------ |
| `@title`      | A title that describes the contract/interface                             | contract, library, interface, struct, enum, enum values                                                |
| `@author`     | The name of the author                                                    | contract, library, interface, struct, enum, enum values                                                |
| `@notice`     | Explain to an end user what this does                                     | contract, library, interface, function, public state variable, event, struct, enum, enum values, error |
| `@dev`        | Explain to a developer any extra details                                  | contract, library, interface, function, state variable, event, struct, enum, enum values, error        |
| `@param`      | Documents a parameter (must be followed by parameter name)                | function, event, enum values, error                                                                    |
| `@return`     | Documents the return variables of a function                              | function, enum, enum values, public state variable                                                     |
| `@inheritdoc` | Copies missing tags from the base (must be followed by the contract name) | function, enum, enum values, public state variable                                                     |
| `@custom:...` | Custom tag; semantics are application-defined                             | everywhere                                                                                             |

- `forge doc` will parse these to autogenerate documentation.
- Etherscan will display them in the contract UI.

1. For simple NatSpec comments, consider just documenting params in the docstring, such as `` /// @notice Returns the sum of `x` and `y`. ``, instead of using `@param` tags.

2. For complex NatSpec comments, consider using a tool like [PlantUML](https://plantuml.com/ascii-art) to generate ASCII art diagrams to help explain complex aspects of the codebase.

3. Any markdown in your comments will carry over properly when generating docs with `forge doc`, so structure comments with markdown when useful.

   - Good: `` /// @notice Returns the sum of `x` and `y`. ``
   - Bad: `/// @notice Returns the sum of x and y.`

## Best Practices

1. **Always document external and public functions** - These are your contract's API and must have clear NatSpec comments.

2. **Use `@inheritdoc` to avoid duplication** - When overriding functions, use `@inheritdoc ContractName` to inherit documentation from parent contracts.

3. **Document state-changing functions thoroughly** - Include:
   - Prerequisites and requirements
   - State changes that will occur
   - Events that will be emitted
   - Potential revert conditions

4. **For complex logic, use `@dev` tags** - Explain implementation details, algorithms, or design decisions that aren't obvious from the code.

5. **Document struct fields** - Each field in a struct should have a comment explaining its purpose:
   ```solidity
   /// @notice User account information
   struct Account {
       address owner;     /// @dev The account owner's address
       uint256 balance;   /// @dev Current balance in wei
       uint256 nonce;     /// @dev Transaction nonce for replay protection
   }
   ```

6. **Use `@custom` tags for protocol-specific information**:
   - `@custom:security` - Security considerations
   - `@custom:experimental` - Experimental features
   - `@custom:oz-upgrades-unsafe-allow` - OpenZeppelin upgrade safety

7. **Document error conditions** - Explain when custom errors are thrown:
   ```solidity
   /// @notice Thrown when transfer amount exceeds balance
   /// @param account The account attempting the transfer
   /// @param balance Current balance of the account
   /// @param needed Amount attempted to transfer
   error InsufficientBalance(address account, uint256 balance, uint256 needed);
   ```

8. **Keep comments up-to-date** - Update documentation whenever functionality changes. Outdated comments are worse than no comments.

9. **Use consistent formatting**:
   - Start with `@notice` for user-facing description
   - Follow with `@dev` for technical details
   - List `@param` tags in order of function parameters
   - End with `@return` for return values

10. **Document assumptions and invariants** - Use `@dev` to explain important assumptions:
    ```solidity
    /// @notice Calculates compound interest
    /// @dev Assumes interest is compounded daily (every 86400 seconds)
    /// @dev Reverts if timeElapsed would cause overflow
    ```

## Example Template

```solidity
/// @title MyContract
/// @author Your Name
/// @notice Brief description of the contract's purpose
/// @dev Detailed technical explanation of the contract
contract MyContract {

    /// @notice Transfers tokens from sender to recipient
    /// @dev Includes safety checks for overflow and insufficient balance
    /// @param to The recipient address
    /// @param amount The amount of tokens to transfer in wei
    /// @return success True if the transfer was successful
    /// @custom:security This function is protected against reentrancy
    function transfer(address to, uint256 amount) external returns (bool success) {
        // Implementation
    }
}
```
